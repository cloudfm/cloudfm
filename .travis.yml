language: rust
sudo: required
dist: trusty
services:
  - postgresql
rust:
  - stable
  - nightly
  - nightly-2016-03-11
install:
  - npm install -g elm
  - psql -c 'create database mp;' -U postgres
  - cd server && cargo install diesel_cli && /home/travis/.cargo/bin/diesel migration run && cd ..
env:
  - DATABASE_URL=postgres://localhost/mp
matrix:
  allow_failures:
    - rust: stable
script: make ci
